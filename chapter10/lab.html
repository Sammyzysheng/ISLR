<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Lab | An Introduction to Statistical Learning:</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.2.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    
        <link rel="stylesheet" href="../styles/website.css">
    

        
    
    
    <link rel="next" href="../chapter10/solutions.html" />
    
    
    <link rel="prev" href="../chapter10/index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="9.1" data-basepath=".." data-revision="Wed Aug 19 2015 19:44:06 GMT+0100 (BST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="chapter2/index.html">
            
                
                    <a href="../chapter2/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Chapter 2. Statistical Learning
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="chapter2/lab.html">
            
                
                    <a href="../chapter2/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter2/solutions.html">
            
                
                    <a href="../chapter2/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="chapter3/index.html">
            
                
                    <a href="../chapter3/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Chapter 3. Linear Regression
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="chapter3/lab.html">
            
                
                    <a href="../chapter3/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="chapter3/solutions.html">
            
                
                    <a href="../chapter3/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="chapter4/index.html">
            
                
                    <a href="../chapter4/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Chapter 4. Classification
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="chapter4/lab.html">
            
                
                    <a href="../chapter4/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="chapter4/solutions.html">
            
                
                    <a href="../chapter4/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="chapter5/index.html">
            
                
                    <a href="../chapter5/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Chapter 5. Resampling Methods
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="chapter5/lab.html">
            
                
                    <a href="../chapter5/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="chapter5/solutions.html">
            
                
                    <a href="../chapter5/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="chapter6/index.html">
            
                
                    <a href="../chapter6/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Chapter 6. Linear Model Selection and Regularization
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="chapter6/lab.html">
            
                
                    <a href="../chapter6/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="chapter6/solutions.html">
            
                
                    <a href="../chapter6/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="chapter7/index.html">
            
                
                    <a href="../chapter7/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Chapter 7. Moving Beyond Linearity
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="chapter7/lab.html">
            
                
                    <a href="../chapter7/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="chapter7/solutions.html">
            
                
                    <a href="../chapter7/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="chapter8/index.html">
            
                
                    <a href="../chapter8/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Chapter 8. Tree-Based Methods
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="chapter8/lab.html">
            
                
                    <a href="../chapter8/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="chapter8/solutions.html">
            
                
                    <a href="../chapter8/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="chapter9/index.html">
            
                
                    <a href="../chapter9/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Chapter 9. Support Vector Machines
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="chapter9/lab.html">
            
                
                    <a href="../chapter9/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="chapter9/solutions.html">
            
                
                    <a href="../chapter9/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="chapter10/index.html">
            
                
                    <a href="../chapter10/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Chapter 10. Unsupervised Learning
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="9.1" data-path="chapter10/lab.html">
            
                
                    <a href="../chapter10/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="chapter10/solutions.html">
            
                
                    <a href="../chapter10/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="references.html">
            
                
                    <a href="../references.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        References
                    </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >An Introduction to Statistical Learning:</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="10-4-lab-1-principal-components-analysis">10.4 Lab 1: Principal Components Analysis</h2>
<p>We use the <a href="http://bit.ly/R_us_arrests" target="_blank"><code>USArrests</code></a> dataset in this exercise to run Principal Component Analysis (PCA). We start by examining the data with some descriptive statistics.</p>
<pre><code class="lang-r">states &lt;- row.names(USArrests)
states
</code></pre>
<pre><code>##  [1] &quot;Alabama&quot;        &quot;Alaska&quot;         &quot;Arizona&quot;        &quot;Arkansas&quot;      
##  [5] &quot;California&quot;     &quot;Colorado&quot;       &quot;Connecticut&quot;    &quot;Delaware&quot;      
##  [9] &quot;Florida&quot;        &quot;Georgia&quot;        &quot;Hawaii&quot;         &quot;Idaho&quot;         
## [13] &quot;Illinois&quot;       &quot;Indiana&quot;        &quot;Iowa&quot;           &quot;Kansas&quot;        
## [17] &quot;Kentucky&quot;       &quot;Louisiana&quot;      &quot;Maine&quot;          &quot;Maryland&quot;      
## [21] &quot;Massachusetts&quot;  &quot;Michigan&quot;       &quot;Minnesota&quot;      &quot;Mississippi&quot;   
## [25] &quot;Missouri&quot;       &quot;Montana&quot;        &quot;Nebraska&quot;       &quot;Nevada&quot;        
## [29] &quot;New Hampshire&quot;  &quot;New Jersey&quot;     &quot;New Mexico&quot;     &quot;New York&quot;      
## [33] &quot;North Carolina&quot; &quot;North Dakota&quot;   &quot;Ohio&quot;           &quot;Oklahoma&quot;      
## [37] &quot;Oregon&quot;         &quot;Pennsylvania&quot;   &quot;Rhode Island&quot;   &quot;South Carolina&quot;
## [41] &quot;South Dakota&quot;   &quot;Tennessee&quot;      &quot;Texas&quot;          &quot;Utah&quot;          
## [45] &quot;Vermont&quot;        &quot;Virginia&quot;       &quot;Washington&quot;     &quot;West Virginia&quot; 
## [49] &quot;Wisconsin&quot;      &quot;Wyoming&quot;
</code></pre><pre><code class="lang-r">names(USArrests)
</code></pre>
<pre><code>## [1] &quot;Murder&quot;   &quot;Assault&quot;  &quot;UrbanPop&quot; &quot;Rape&quot;
</code></pre><p>Let&apos;s check the mean and variance of the USArrests dataset.</p>
<pre><code class="lang-r">apply(USArrests, <span class="hljs-number">2</span>, mean)
</code></pre>
<pre><code>##   Murder  Assault UrbanPop     Rape 
##    7.788  170.760   65.540   21.232
</code></pre><pre><code class="lang-r">apply(USArrests, <span class="hljs-number">2</span>, var)
</code></pre>
<pre><code>##     Murder    Assault   UrbanPop       Rape 
##   18.97047 6945.16571  209.51878   87.72916
</code></pre><p>We run PCA on our dataset using the <a href="http://bit.ly/R_prcomp" target="_blank"><code>prcomp()</code></a> function.</p>
<pre><code class="lang-r">pr.out &lt;- prcomp(USArrests, scale = <span class="hljs-literal">TRUE</span>)
</code></pre>
<p>Now lets examing the results from The <a href="http://bit.ly/R_prcomp" target="_blank"><code>prcomp()</code></a> function.</p>
<pre><code class="lang-r">names(pr.out)
</code></pre>
<pre><code>## [1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;
</code></pre><p>The <code>center</code> and <code>scale</code> components contain the mean and standard deviations prior to scaling.</p>
<pre><code class="lang-r">pr.out$center
</code></pre>
<pre><code>##   Murder  Assault UrbanPop     Rape 
##    7.788  170.760   65.540   21.232
</code></pre><pre><code class="lang-r">pr.out$scale
</code></pre>
<pre><code>##    Murder   Assault  UrbanPop      Rape 
##  4.355510 83.337661 14.474763  9.366385
</code></pre><p>The <code>rotation</code> component correspondes to the rotation matrix whose columns contain the eigenvectors.</p>
<pre><code class="lang-r">pr.out$rotation
</code></pre>
<pre><code>##                 PC1        PC2        PC3         PC4
## Murder   -0.5358995  0.4181809 -0.3412327  0.64922780
## Assault  -0.5831836  0.1879856 -0.2681484 -0.74340748
## UrbanPop -0.2781909 -0.8728062 -0.3780158  0.13387773
## Rape     -0.5434321 -0.1673186  0.8177779  0.08902432
</code></pre><p>Let&apos;s check the dimentions of <code>x</code> component which returns the rotated data.</p>
<pre><code class="lang-r">dim(pr.out$x)
</code></pre>
<pre><code>## [1] 50  4
</code></pre><p>We then plot the first two principal components using <a href="http://bit.ly/R_biplot" target="_blank"><code>biplot()</code></a>.</p>
<pre><code class="lang-r">biplot(pr.out, scale = <span class="hljs-number">0</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-10-1.png" alt=""></p>
<pre><code class="lang-r">pr.out$rotation &lt;- -pr.out$rotation
pr.out$x &lt;- -pr.out$x
biplot(pr.out, scale = <span class="hljs-number">0</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-11-1.png" alt=""></p>
<p>We can compute the variance associated with each principal component from the standard deviation returned by <a href="http://bit.ly/R_prcomp" target="_blank"><code>prcomp()</code></a>.</p>
<pre><code class="lang-r">pr.out$sdev
</code></pre>
<pre><code>## [1] 1.5748783 0.9948694 0.5971291 0.4164494
</code></pre><pre><code class="lang-r">pr.var &lt;- pr.out$sdev^<span class="hljs-number">2</span>
pr.var
</code></pre>
<pre><code>## [1] 2.4802416 0.9897652 0.3565632 0.1734301
</code></pre><p>Let&apos;s compute the proportional variance as well.</p>
<pre><code class="lang-r">pve &lt;- pr.var/sum(pr.var)
pve
</code></pre>
<pre><code>## [1] 0.62006039 0.24744129 0.08914080 0.04335752
</code></pre><p>Now we can plot the proportional variance for each principal component.</p>
<pre><code class="lang-r">plot(pve, xlab = <span class="hljs-string">&quot;Principal Component&quot;</span>, ylab = <span class="hljs-string">&quot;Proportion of Variance Explained &quot;</span>, ylim = c(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), type = <span class="hljs-string">&quot;b&quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-15-1.png" alt=""></p>
<pre><code class="lang-r">plot(cumsum(pve), xlab = <span class="hljs-string">&quot;Principal Component &quot;</span>, ylab = <span class="hljs-string">&quot; Cumulative Proportion of Variance Explained &quot;</span>, ylim = c(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), type = <span class="hljs-string">&quot;b&quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-15-2.png" alt=""></p>
<pre><code class="lang-r">a &lt;- c(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, -<span class="hljs-number">3</span>)
cumsum(a)
</code></pre>
<pre><code>## [1]  1  3 11  8
</code></pre><h2 id="10-5-lab-2-clustering">10.5 Lab 2: Clustering</h2>
<h3 id="10-5-1-k-means-clustering">10.5.1 K-Means Clustering</h3>
<p>In this exercise we use K-Means clustering on randomly generated data using the <a href="http://bit.ly/R_kmeans" target="_blank"><code>kmeans()</code></a> function.</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">2</span>)
x &lt;- matrix(rnorm(<span class="hljs-number">50</span> * <span class="hljs-number">2</span>), ncol = <span class="hljs-number">2</span>)
x[<span class="hljs-number">1</span>:<span class="hljs-number">25</span>, <span class="hljs-number">1</span>] &lt;- x[<span class="hljs-number">1</span>:<span class="hljs-number">25</span>, <span class="hljs-number">1</span>] + <span class="hljs-number">3</span>
x[<span class="hljs-number">1</span>:<span class="hljs-number">25</span>, <span class="hljs-number">2</span>] &lt;- x[<span class="hljs-number">1</span>:<span class="hljs-number">25</span>, <span class="hljs-number">2</span>] - <span class="hljs-number">4</span>
</code></pre>
<p>Let&apos;s start by clustering the data into two clusters with <code>K = 2</code>.</p>
<pre><code class="lang-r">km.out &lt;- kmeans(x, <span class="hljs-number">2</span>, nstart = <span class="hljs-number">20</span>)
</code></pre>
<p>The <a href="http://bit.ly/R_kmeans" target="_blank"><code>kmeans()</code></a> function returns the cluster assignments in the <code>cluster</code> component.</p>
<pre><code class="lang-r">km.out$cluster
</code></pre>
<pre><code>##  [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1
## [36] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
</code></pre><p>Now let&apos;s plot the clusters.</p>
<pre><code class="lang-r">plot(x, col = (km.out$cluster + <span class="hljs-number">1</span>), main = <span class="hljs-string">&quot;K-Means Clustering Results with K=2&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;&quot;</span>, pch = <span class="hljs-number">20</span>, cex = <span class="hljs-number">2</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-20-1.png" alt=""></p>
<p>We can run K-means with different values for the number of clusters such as <code>K = 3</code> and plot the results.</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">4</span>)
km.out &lt;- kmeans(x, <span class="hljs-number">3</span>, nstart = <span class="hljs-number">20</span>)
km.out
</code></pre>
<pre><code>## K-means clustering with 3 clusters of sizes 10, 23, 17
## 
## Cluster means:
##         [,1]        [,2]
## 1  2.3001545 -2.69622023
## 2 -0.3820397 -0.08740753
## 3  3.7789567 -4.56200798
## 
## Clustering vector:
##  [1] 3 1 3 1 3 3 3 1 3 1 3 1 3 1 3 1 3 3 3 3 3 1 3 3 3 2 2 2 2 2 2 2 2 2 2
## [36] 2 2 2 2 2 2 2 2 1 2 1 2 2 2 2
## 
## Within cluster sum of squares by cluster:
## [1] 19.56137 52.67700 25.74089
##  (between_SS / total_SS =  79.3 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    
## [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        
## [9] &quot;ifault&quot;
</code></pre><pre><code class="lang-r">plot(x, col = (km.out$cluster + <span class="hljs-number">1</span>), main = <span class="hljs-string">&quot;K-Means Clustering Results with K=3&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;&quot;</span>, pch = <span class="hljs-number">20</span>, cex = <span class="hljs-number">2</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-22-1.png" alt=""></p>
<p>We can control the initial cluster assignments with the <code>nstart</code> argument to <a href="http://bit.ly/R_kmeans" target="_blank"><code>kmeans()</code></a>.</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">3</span>)
km.out &lt;- kmeans(x, <span class="hljs-number">3</span>, nstart = <span class="hljs-number">1</span>)
km.out$tot.withinss
</code></pre>
<pre><code>## [1] 104.3319
</code></pre><pre><code class="lang-r">km.out &lt;- kmeans(x, <span class="hljs-number">3</span>, nstart = <span class="hljs-number">20</span>)
km.out$tot.withinss
</code></pre>
<pre><code>## [1] 97.97927
</code></pre><h3 id="10-5-2-hierarchical-clustering">10.5.2 Hierarchical Clustering</h3>
<p>We can use hierarchical clustering on the dataset we generated in the previous exercise using the <a href="http://bit.ly/R_hclust" target="_blank"><code>hclust()</code></a> function.</p>
<pre><code class="lang-r">hc.complete &lt;- hclust(dist(x), method = <span class="hljs-string">&quot;complete&quot;</span>)
</code></pre>
<p>The <a href="http://bit.ly/R_hclust" target="_blank"><code>hclust()</code></a> function supports various agglomeration methods including &quot;single&quot;, &quot;complete&quot;, and &quot;average&quot; linkages.</p>
<pre><code class="lang-r">hc.average &lt;- hclust(dist(x), method = <span class="hljs-string">&quot;average&quot;</span>)
hc.single &lt;- hclust(dist(x), method = <span class="hljs-string">&quot;single&quot;</span>)
</code></pre>
<p>We can compare the different linkages by plotting the results obtained with different methods.</p>
<pre><code class="lang-r">par(mfrow = c(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>))
plot(hc.complete, main = <span class="hljs-string">&quot;Complete Linkage&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>, cex = <span class="hljs-number">0.9</span>)
plot(hc.average, main = <span class="hljs-string">&quot;Average Linkage&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>, cex = <span class="hljs-number">0.9</span>)
plot(hc.single, main = <span class="hljs-string">&quot;Single Linkage&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>, cex = <span class="hljs-number">0.9</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-26-1.png" alt=""></p>
<p>We can cut the tree into different groups using the <a href="http://bit.ly/R_cutree" target="_blank"><code>cutree()</code></a> function.</p>
<pre><code class="lang-r">cutree(hc.complete, <span class="hljs-number">2</span>)
</code></pre>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2
## [36] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
</code></pre><pre><code class="lang-r">cutree(hc.average, <span class="hljs-number">2</span>)
</code></pre>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 1 2 2
## [36] 2 2 2 2 2 2 2 2 1 2 1 2 2 2 2
</code></pre><pre><code class="lang-r">cutree(hc.single, <span class="hljs-number">2</span>)
</code></pre>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [36] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
</code></pre><pre><code class="lang-r">cutree(hc.single, <span class="hljs-number">4</span>)
</code></pre>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3
## [36] 3 3 3 3 3 3 4 3 3 3 3 3 3 3 3
</code></pre><p>We can scale the dataset before it to the clustering algorithm by first calling <a href="http://bit.ly/R_scale" target="_blank"><code>scale()</code></a>.</p>
<pre><code class="lang-r">xsc &lt;- scale(x)
plot(hclust(dist(xsc), method = <span class="hljs-string">&quot;complete&quot;</span>), main = <span class="hljs-string">&quot;Hierarchical Clustering with Scaled Features &quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-29-1.png" alt=""></p>
<pre><code class="lang-r">x &lt;- matrix(rnorm(<span class="hljs-number">30</span> * <span class="hljs-number">3</span>), ncol = <span class="hljs-number">3</span>)
dd &lt;- as.dist(<span class="hljs-number">1</span> - cor(t(x)))
plot(hclust(dd, method = <span class="hljs-string">&quot;complete&quot;</span>), main = <span class="hljs-string">&quot;Complete Linkage with Correlation -Based Distance&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-30-1.png" alt=""></p>
<h2 id="10-6-lab-3-nci60-data-example">10.6 Lab 3: NCI60 Data Example</h2>
<p>In this exercise, we apply PCA and clustering algorithms to the gene expression dataset from the Stanford NC160 Cancer Microarray Project.</p>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(ISLR)
nci.labs &lt;- NCI60$labs
nci.data &lt;- NCI60$data
</code></pre>
<p>Let&apos;s examine the dimensions of the dataset.</p>
<pre><code class="lang-r">dim(nci.data)
</code></pre>
<pre><code>## [1]   64 6830
</code></pre><p>The <a href="http://bit.ly/R_table" target="_blank"><code>table()</code></a> function can be used to produce crosstabs from the dataset.</p>
<pre><code class="lang-r">nci.labs[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>]
</code></pre>
<pre><code>## [1] &quot;CNS&quot;   &quot;CNS&quot;   &quot;CNS&quot;   &quot;RENAL&quot;
</code></pre><pre><code class="lang-r">table(nci.labs)
</code></pre>
<pre><code>## nci.labs
##      BREAST         CNS       COLON K562A-repro K562B-repro    LEUKEMIA 
##           7           5           7           1           1           6 
## MCF7A-repro MCF7D-repro    MELANOMA       NSCLC     OVARIAN    PROSTATE 
##           1           1           8           9           6           2 
##       RENAL     UNKNOWN 
##           9           1
</code></pre><h3 id="10-6-1-pca-on-the-nci60-data">10.6.1 PCA on the NCI60 Data</h3>
<p>We use <a href="http://bit.ly/R_prcomp" target="_blank"><code>prcomp()</code></a> to run principal component analysis as shown in the PCA exercise above.</p>
<pre><code class="lang-r">pr.out &lt;- prcomp(nci.data, scale = <span class="hljs-literal">TRUE</span>)
</code></pre>
<p>We create a function to assign unique colors to each cancer type.</p>
<pre><code class="lang-r">Cols &lt;- <span class="hljs-keyword">function</span>(vec) {
    cols &lt;- rainbow(length(unique(vec)))
    <span class="hljs-keyword">return</span>(cols[as.numeric(as.factor(vec))])
}
</code></pre>
<p>We can now use our <code>Cols()</code> function to plot the PCA results.</p>
<pre><code class="lang-r">par(mfrow = c(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))
plot(pr.out$x[, <span class="hljs-number">1</span>:<span class="hljs-number">2</span>], col = Cols(nci.labs), pch = <span class="hljs-number">19</span>, xlab = <span class="hljs-string">&quot;Z1&quot;</span>, ylab = <span class="hljs-string">&quot;Z2&quot;</span>)
plot(pr.out$x[, c(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)], col = Cols(nci.labs), pch = <span class="hljs-number">19</span>, xlab = <span class="hljs-string">&quot;Z1&quot;</span>, ylab = <span class="hljs-string">&quot;Z3&quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-36-1.png" alt=""></p>
<p>We can get a summary of the proportional variance and plot the variance explained by each principal component.</p>
<pre><code class="lang-r">summary(pr.out)
</code></pre>
<pre><code>## Importance of components:
##                            PC1      PC2      PC3      PC4      PC5
## Standard deviation     27.8535 21.48136 19.82046 17.03256 15.97181
## Proportion of Variance  0.1136  0.06756  0.05752  0.04248  0.03735
## Cumulative Proportion   0.1136  0.18115  0.23867  0.28115  0.31850
##                             PC6      PC7      PC8      PC9     PC10
## Standard deviation     15.72108 14.47145 13.54427 13.14400 12.73860
## Proportion of Variance  0.03619  0.03066  0.02686  0.02529  0.02376
## Cumulative Proportion   0.35468  0.38534  0.41220  0.43750  0.46126
##                            PC11     PC12     PC13     PC14     PC15
## Standard deviation     12.68672 12.15769 11.83019 11.62554 11.43779
## Proportion of Variance  0.02357  0.02164  0.02049  0.01979  0.01915
## Cumulative Proportion   0.48482  0.50646  0.52695  0.54674  0.56590
##                            PC16     PC17     PC18     PC19    PC20
## Standard deviation     11.00051 10.65666 10.48880 10.43518 10.3219
## Proportion of Variance  0.01772  0.01663  0.01611  0.01594  0.0156
## Cumulative Proportion   0.58361  0.60024  0.61635  0.63229  0.6479
##                            PC21    PC22    PC23    PC24    PC25    PC26
## Standard deviation     10.14608 10.0544 9.90265 9.64766 9.50764 9.33253
## Proportion of Variance  0.01507  0.0148 0.01436 0.01363 0.01324 0.01275
## Cumulative Proportion   0.66296  0.6778 0.69212 0.70575 0.71899 0.73174
##                           PC27   PC28    PC29    PC30    PC31    PC32
## Standard deviation     9.27320 9.0900 8.98117 8.75003 8.59962 8.44738
## Proportion of Variance 0.01259 0.0121 0.01181 0.01121 0.01083 0.01045
## Cumulative Proportion  0.74433 0.7564 0.76824 0.77945 0.79027 0.80072
##                           PC33    PC34    PC35    PC36    PC37    PC38
## Standard deviation     8.37305 8.21579 8.15731 7.97465 7.90446 7.82127
## Proportion of Variance 0.01026 0.00988 0.00974 0.00931 0.00915 0.00896
## Cumulative Proportion  0.81099 0.82087 0.83061 0.83992 0.84907 0.85803
##                           PC39    PC40    PC41   PC42    PC43   PC44
## Standard deviation     7.72156 7.58603 7.45619 7.3444 7.10449 7.0131
## Proportion of Variance 0.00873 0.00843 0.00814 0.0079 0.00739 0.0072
## Cumulative Proportion  0.86676 0.87518 0.88332 0.8912 0.89861 0.9058
##                           PC45   PC46    PC47    PC48    PC49    PC50
## Standard deviation     6.95839 6.8663 6.80744 6.64763 6.61607 6.40793
## Proportion of Variance 0.00709 0.0069 0.00678 0.00647 0.00641 0.00601
## Cumulative Proportion  0.91290 0.9198 0.92659 0.93306 0.93947 0.94548
##                           PC51    PC52    PC53    PC54    PC55    PC56
## Standard deviation     6.21984 6.20326 6.06706 5.91805 5.91233 5.73539
## Proportion of Variance 0.00566 0.00563 0.00539 0.00513 0.00512 0.00482
## Cumulative Proportion  0.95114 0.95678 0.96216 0.96729 0.97241 0.97723
##                           PC57   PC58    PC59    PC60    PC61    PC62
## Standard deviation     5.47261 5.2921 5.02117 4.68398 4.17567 4.08212
## Proportion of Variance 0.00438 0.0041 0.00369 0.00321 0.00255 0.00244
## Cumulative Proportion  0.98161 0.9857 0.98940 0.99262 0.99517 0.99761
##                           PC63      PC64
## Standard deviation     4.04124 2.148e-14
## Proportion of Variance 0.00239 0.000e+00
## Cumulative Proportion  1.00000 1.000e+00
</code></pre><pre><code class="lang-r">plot(pr.out)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-37-1.png" alt=""></p>
<p>We can also plot the proportional variance explained (PVE) and the cummulative PVE for each principal component.</p>
<pre><code class="lang-r">pve &lt;- <span class="hljs-number">100</span> * pr.out$sdev^<span class="hljs-number">2</span>/sum(pr.out$sdev^<span class="hljs-number">2</span>)
par(mfrow = c(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))
plot(pve, type = <span class="hljs-string">&quot;o&quot;</span>, ylab = <span class="hljs-string">&quot;PVE&quot;</span>, xlab = <span class="hljs-string">&quot;Principal Component&quot;</span>, col = <span class="hljs-string">&quot; blue &quot;</span>)
plot(cumsum(pve), type = <span class="hljs-string">&quot;o&quot;</span>, ylab = <span class="hljs-string">&quot;Cumulative PVE&quot;</span>, xlab = <span class="hljs-string">&quot;Principal Component &quot;</span>, col = <span class="hljs-string">&quot; brown3 &quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-38-1.png" alt=""></p>
<h3 id="10-6-2-clustering-the-observations-of-the-nci60-data">10.6.2 Clustering the Observations of the NCI60 Data</h3>
<p>In this final exercise we use heirchical and K-means clustering on the NC160 dataset. We first scale the data to have a zero mean and standard deviation of one.</p>
<pre><code class="lang-r">sd.data &lt;- scale(nci.data)
</code></pre>
<p>We run heirchical clustering with different linakges and plot the results.</p>
<pre><code class="lang-r">par(mfrow = c(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>))
data.dist &lt;- dist(sd.data)
plot(hclust(data.dist), labels = nci.labs, main = <span class="hljs-string">&quot;Complete Linkage&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;&quot;</span>)
plot(hclust(data.dist, method = <span class="hljs-string">&quot;average&quot;</span>), labels = nci.labs, main = <span class="hljs-string">&quot;Average Linkage&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;&quot;</span>)
plot(hclust(data.dist, method = <span class="hljs-string">&quot;single&quot;</span>), labels = nci.labs, main = <span class="hljs-string">&quot;Single Linkage&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, sub = <span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;&quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-40-1.png" alt=""></p>
<p>We cut the tree to give us four clusters using <a href="http://bit.ly/R_cutree" target="_blank"><code>cutree()</code></a>.</p>
<pre><code class="lang-r">hc.out &lt;- hclust(dist(sd.data))
hc.clusters &lt;- cutree(hc.out, <span class="hljs-number">4</span>)
table(hc.clusters, nci.labs)
</code></pre>
<pre><code>##            nci.labs
## hc.clusters BREAST CNS COLON K562A-repro K562B-repro LEUKEMIA MCF7A-repro
##           1      2   3     2           0           0        0           0
##           2      3   2     0           0           0        0           0
##           3      0   0     0           1           1        6           0
##           4      2   0     5           0           0        0           1
##            nci.labs
## hc.clusters MCF7D-repro MELANOMA NSCLC OVARIAN PROSTATE RENAL UNKNOWN
##           1           0        8     8       6        2     8       1
##           2           0        0     1       0        0     1       0
##           3           0        0     0       0        0     0       0
##           4           1        0     0       0        0     0       0
</code></pre><p>And plot the results with four clusters.</p>
<pre><code class="lang-r">par(mfrow = c(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))
plot(hc.out, labels = nci.labs)
abline(h = <span class="hljs-number">139</span>, col = <span class="hljs-string">&quot;red&quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-42-1.png" alt=""></p>
<p>We can get a summary of the result from the return value of <a href="http://bit.ly/R_hclust" target="_blank"><code>hclust()</code></a>.</p>
<pre><code class="lang-r">hc.out
</code></pre>
<pre><code>## 
## Call:
## hclust(d = dist(sd.data))
## 
## Cluster method   : complete 
## Distance         : euclidean 
## Number of objects: 64
</code></pre><p>For clustering the cancer types in four groups with K-means, we simply run <a href="http://bit.ly/R_kmeans" target="_blank"><code>kmeans()</code></a> with <code>K = 4</code>.</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">2</span>)
km.out &lt;- kmeans(sd.data, <span class="hljs-number">4</span>, nstart = <span class="hljs-number">20</span>)
km.clusters &lt;- km.out$cluster
table(km.clusters, hc.clusters)
</code></pre>
<pre><code>##            hc.clusters
## km.clusters  1  2  3  4
##           1 11  0  0  9
##           2  0  0  8  0
##           3  9  0  0  0
##           4 20  7  0  0
</code></pre><p>We can also combine the different algorithms by first running principal component analysis and then performing heirchical clustering on the first few principal components.</p>
<pre><code class="lang-r">hc.out &lt;- hclust(dist(pr.out$x[, <span class="hljs-number">1</span>:<span class="hljs-number">5</span>]))
plot(hc.out, labels = nci.labs, main = <span class="hljs-string">&quot;Hier. Clust. on First Five Score Vectors &quot;</span>)
</code></pre>
<p><img src="lab_files/figure-markdown_github+backtick_code_blocks+autolink_bare_uris/unnamed-chunk-45-1.png" alt=""></p>
<pre><code class="lang-r">table(cutree(hc.out, <span class="hljs-number">4</span>), nci.labs)
</code></pre>
<pre><code>##    nci.labs
##     BREAST CNS COLON K562A-repro K562B-repro LEUKEMIA MCF7A-repro
##   1      0   2     7           0           0        2           0
##   2      5   3     0           0           0        0           0
##   3      0   0     0           1           1        4           0
##   4      2   0     0           0           0        0           1
##    nci.labs
##     MCF7D-repro MELANOMA NSCLC OVARIAN PROSTATE RENAL UNKNOWN
##   1           0        1     8       5        2     7       0
##   2           0        7     1       1        0     2       1
##   3           0        0     0       0        0     0       0
##   4           1        0     0       0        0     0       0
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../chapter10/index.html" class="navigation navigation-prev " aria-label="Previous page: Chapter 10. Unsupervised Learning"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../chapter10/solutions.html" class="navigation navigation-next " aria-label="Next page: Solutions"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
